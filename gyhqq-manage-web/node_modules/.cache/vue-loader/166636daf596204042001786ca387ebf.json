{"remainingRequest":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\src\\views\\item\\specification\\SpecParam.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\src\\views\\item\\specification\\SpecParam.vue","mtime":1566198667909},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1566198635392},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1566198634345},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1566198662963},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1566198635392},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1566198662436}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  name: \"v-spec-param\",\n  props: {\n    group: {\n      type: Object\n    }\n  },\n  data() {\n    return {\n      headers: [\n        {text: \"id\", value: \"id\", align: \"center\", sortable: false},\n        {text: \"参数名\", value: \"name\", align: \"center\", sortable: false},\n        {\n          text: \"是否为数值\", value: \"isNumeric\",\n          align: \"center\",\n          sortable: false\n        },\n        {text: \"单位\", value: \"unit\", align: \"center\", sortable: false},\n        {\n          text: \"是否通用\",\n          value: \"generic\",\n          align: \"center\",\n          sortable: false\n        },\n        {\n          text: \"是否可搜索\",\n          value: \"searching\",\n          align: \"center\",\n          sortable: false\n        },\n        {text: \"操作\", align: \"center\", sortable: false}\n      ],\n      params: [], // 参数\n      show: false,\n      param: {},\n      isEdit: false\n    };\n  },\n  watch: {\n    group: {\n      deep: true,\n      handler(val) {\n        if (val && val.id) {\n          this.loadData();\n        }\n      }\n    }\n  },\n  methods: {\n    loadData() {\n      this.$http\n        .get(\"/item/spec/params?gid=\" + this.group.id)\n        .then(({data}) => {\n          data.forEach(p => {\n            p.segments = p.segments ? p.segments.split(\",\").map(s => s.split(\"-\")) : [];\n          })\n          this.params = data;\n        })\n        .catch(() => {\n          this.params = [];\n        });\n    },\n    editParam(param) {\n      this.param = param;\n      this.isEdit = true;\n      this.show = true;\n    },\n    addParam() {\n      this.param = {\n        cid: this.group.cid,\n        groupId: this.group.id,\n        segments: [],\n        isNumeric: false,\n        searching: false,\n        generic: false\n      }\n      this.show = true;\n    },\n    deleteParam(id) {\n      this.$message.confirm(\"确认要删除该参数吗？\")\n        .then(() => {\n          this.$http.delete(\"/item/spec/param/\" + id)\n            .then(() => {\n              this.$message.success(\"删除成功\");\n            })\n            .catch(() => {\n              this.$message.error(\"删除失败\");\n            })\n        })\n    },\n    formatBoolean(boo) {\n      return boo ? \"是\" : \"否\";\n    },\n    save() {\n      const p = {};\n      Object.assign(p, this.param);\n      p.segments = p.segments.map(s => s.join(\"-\")).join(\",\")\n      this.$http({\n        method: this.isEdit ? 'put' : 'post',\n        url: '/item/spec/param',\n        data: p,\n      }).then(() => {\n        // 关闭窗口\n        this.show = false;\n        this.$message.success(\"保存成功！\");\n        this.loadData();\n      }).catch(() => {\n        this.$message.error(\"保存失败！\");\n      });\n    }\n  }\n};\n",{"version":3,"sources":["SpecParam.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SpecParam.vue","sourceRoot":"src/views/item/specification","sourcesContent":["<template>\r\n  <div>\r\n    <v-data-table\r\n      :headers=\"headers\"\r\n      :items=\"params\"\r\n      hide-actions\r\n      class=\"elevation-0\"\r\n    >\r\n      <template slot=\"items\" slot-scope=\"props\">\r\n        <td class=\"text-xs-center\">{{ props.item.id }}</td>\r\n        <td class=\"text-xs-center\">{{ props.item.name }}</td>\r\n        <td class=\"text-xs-center\">{{ formatBoolean(props.item.isNumeric) }}</td>\r\n        <td class=\"text-xs-center\">{{ props.item.unit || '无' }}</td>\r\n        <td class=\"text-xs-center\">{{ formatBoolean(props.item.generic) }}</td>\r\n        <td class=\"text-xs-center\">{{ formatBoolean(props.item.searching) }}</td>\r\n        <td class=\"justify-center layout px-0\">\r\n          <v-btn icon @click=\"editParam(props.item)\">\r\n            <i class=\"el-icon-edit\"/>\r\n          </v-btn>\r\n          <v-btn icon @click=\"deleteParam(props.item.id)\">\r\n            <i class=\"el-icon-delete\"/>\r\n          </v-btn>\r\n        </td>\r\n      </template>\r\n      <template slot=\"no-data\">\r\n        该分组下没有参数\r\n      </template>\r\n    </v-data-table>\r\n    <v-btn color='primary' @click=\"addParam\">新增参数</v-btn>\r\n    <v-dialog v-model=\"show\" max-width=\"350px\" scrollable>\r\n      <v-card>\r\n        <v-card-text style=\"height: 300px;\">\r\n          <v-flex class=\"px-3\">\r\n            <v-text-field label=\"参数名称：\" v-model=\"param.name\"/>\r\n            <v-checkbox label=\"是否为通用属性\" v-model=\"param.generic\" color=\"primary\" hide-details/>\r\n            <v-checkbox label=\"是否为数值类型\" v-model=\"param.isNumeric\" color=\"primary\" hide-details/>\r\n            <v-text-field label=\"数值单位：\" v-model=\"param.unit\" v-if=\"param.isNumeric\"/>\r\n            <v-checkbox label=\"是否用于搜索\" v-model=\"param.searching\" color=\"primary\" hide-details/>\r\n            <v-flex v-if=\"param.searching && param.isNumeric\" class=\"px-2\">\r\n              搜索过滤区间：\r\n              <v-layout row wrap v-for=\"(s,i) in param.segments\" :key=\"i\">\r\n                <v-flex xs5>\r\n                  <v-text-field prefix=\"From: \" v-model=\"s[0]\" single-line hide-details/>\r\n                </v-flex>\r\n                <v-spacer/>\r\n                <v-flex xs5>\r\n                  <v-text-field prefix=\"To: \" v-model=\"s[1]\" single-line hide-details/>\r\n                </v-flex>\r\n                <v-flex xs1>\r\n                  <v-btn icon @click=\"param.segments.splice(i,1)\">\r\n                    <i class=\"el-icon-delete\"/>\r\n                  </v-btn>\r\n                </v-flex>\r\n              </v-layout>\r\n              <v-layout row>\r\n                <v-spacer/>\r\n                <v-flex xs1>\r\n                  <v-tooltip left>\r\n                    <v-btn slot=\"activator\" icon @click=\"param.segments.push([0,0])\">\r\n                      <v-icon>add</v-icon>\r\n                    </v-btn>\r\n                    <span>点击为数值类型的参数添加分段，便于搜索过滤</span>\r\n                  </v-tooltip>\r\n                </v-flex>\r\n              </v-layout>\r\n            </v-flex>\r\n          </v-flex>\r\n        </v-card-text>\r\n        <v-card-actions>\r\n          <v-spacer/>\r\n          <v-btn color=\"blue darken-1\" flat @click.native=\"show=false\">取消</v-btn>\r\n          <v-btn color=\"blue darken-1\" flat @click.native=\"save\">保存</v-btn>\r\n        </v-card-actions>\r\n      </v-card>\r\n    </v-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\n  export default {\r\n    name: \"v-spec-param\",\r\n    props: {\r\n      group: {\r\n        type: Object\r\n      }\r\n    },\r\n    data() {\r\n      return {\r\n        headers: [\r\n          {text: \"id\", value: \"id\", align: \"center\", sortable: false},\r\n          {text: \"参数名\", value: \"name\", align: \"center\", sortable: false},\r\n          {\r\n            text: \"是否为数值\", value: \"isNumeric\",\r\n            align: \"center\",\r\n            sortable: false\r\n          },\r\n          {text: \"单位\", value: \"unit\", align: \"center\", sortable: false},\r\n          {\r\n            text: \"是否通用\",\r\n            value: \"generic\",\r\n            align: \"center\",\r\n            sortable: false\r\n          },\r\n          {\r\n            text: \"是否可搜索\",\r\n            value: \"searching\",\r\n            align: \"center\",\r\n            sortable: false\r\n          },\r\n          {text: \"操作\", align: \"center\", sortable: false}\r\n        ],\r\n        params: [], // 参数\r\n        show: false,\r\n        param: {},\r\n        isEdit: false\r\n      };\r\n    },\r\n    watch: {\r\n      group: {\r\n        deep: true,\r\n        handler(val) {\r\n          if (val && val.id) {\r\n            this.loadData();\r\n          }\r\n        }\r\n      }\r\n    },\r\n    methods: {\r\n      loadData() {\r\n        this.$http\r\n          .get(\"/item/spec/params?gid=\" + this.group.id)\r\n          .then(({data}) => {\r\n            data.forEach(p => {\r\n              p.segments = p.segments ? p.segments.split(\",\").map(s => s.split(\"-\")) : [];\r\n            })\r\n            this.params = data;\r\n          })\r\n          .catch(() => {\r\n            this.params = [];\r\n          });\r\n      },\r\n      editParam(param) {\r\n        this.param = param;\r\n        this.isEdit = true;\r\n        this.show = true;\r\n      },\r\n      addParam() {\r\n        this.param = {\r\n          cid: this.group.cid,\r\n          groupId: this.group.id,\r\n          segments: [],\r\n          isNumeric: false,\r\n          searching: false,\r\n          generic: false\r\n        }\r\n        this.show = true;\r\n      },\r\n      deleteParam(id) {\r\n        this.$message.confirm(\"确认要删除该参数吗？\")\r\n          .then(() => {\r\n            this.$http.delete(\"/item/spec/param/\" + id)\r\n              .then(() => {\r\n                this.$message.success(\"删除成功\");\r\n              })\r\n              .catch(() => {\r\n                this.$message.error(\"删除失败\");\r\n              })\r\n          })\r\n      },\r\n      formatBoolean(boo) {\r\n        return boo ? \"是\" : \"否\";\r\n      },\r\n      save() {\r\n        const p = {};\r\n        Object.assign(p, this.param);\r\n        p.segments = p.segments.map(s => s.join(\"-\")).join(\",\")\r\n        this.$http({\r\n          method: this.isEdit ? 'put' : 'post',\r\n          url: '/item/spec/param',\r\n          data: p,\r\n        }).then(() => {\r\n          // 关闭窗口\r\n          this.show = false;\r\n          this.$message.success(\"保存成功！\");\r\n          this.loadData();\r\n        }).catch(() => {\r\n          this.$message.error(\"保存失败！\");\r\n        });\r\n      }\r\n    }\r\n  };\r\n</script>\r\n"]}]}
{"remainingRequest":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\src\\components\\tree\\TreeItem.vue?vue&type=style&index=0&id=0db83a62&scoped=true&lang=css&","dependencies":[{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\src\\components\\tree\\TreeItem.vue","mtime":1566198667882},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\css-loader\\index.js","mtime":1566198640111},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1566198662439},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\postcss-loader\\src\\index.js","mtime":1566198655128},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1566198662963},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1566198635392},{"path":"C:\\Projects\\IDEA\\hobby\\store\\gyhqq-manage-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1566198662436}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.level1 {\n  height: 40px;\n}\n\n.selected {\n  background-color: rgba(105,184,249,0.75);\n}\n\n.material-icons{\n  line-height:1.7\n}\n",{"version":3,"sources":["TreeItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyMA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"TreeItem.vue","sourceRoot":"src/components/tree","sourcesContent":["<template>\r\n  <div>\r\n    <v-list-tile\r\n      @click=\"toggle\" class=\"level1 py-0 my-0\" :class=\"{'selected':isSelected}\">\r\n      <v-list-tile-avatar class=\"px-1\">\r\n        <v-icon v-if=\"model.isParent\">{{open ? 'mdi-folder-open' : 'mdi-folder'}}</v-icon>\r\n        <v-icon v-if=\"!model.isParent\">mdi-file-outline</v-icon>\r\n      </v-list-tile-avatar>\r\n      <v-list-tile-content>\r\n        <v-list-tile-title v-show=\"!beginEdit\">\r\n          <span >{{model.name}}</span>\r\n        </v-list-tile-title>\r\n        <input v-show=\"beginEdit\" @click.stop=\"\" :ref=\"model.id\" v-model=\"model.name\"\r\n               @blur=\"afterEdit\" @keydown.enter=\"afterEdit\"/>\r\n      </v-list-tile-content>\r\n      <v-list-tile-action v-if=\"isEdit\">\r\n        <v-btn icon @mouseover=\"c1='primary'\" @mouseout=\"c1=''\" :color=\"c1\" @click.stop=\"addChild\">\r\n          <i class=\"el-icon-plus\"/>\r\n        </v-btn>\r\n      </v-list-tile-action>\r\n      <v-list-tile-action v-if=\"isEdit\">\r\n        <v-btn icon @mouseover=\"c2='success'\" @mouseout=\"c2=''\" :color=\"c2\" @click.stop=\"editChild\">\r\n          <i class=\"el-icon-edit\"/>\r\n        </v-btn>\r\n      </v-list-tile-action>\r\n      <v-list-tile-action v-if=\"isEdit\">\r\n        <v-btn icon @mouseover=\"c3='error'\" @mouseout=\"c3=''\" :color=\"c3\" @click.stop=\"deleteChild\">\r\n          <i class=\"el-icon-delete\"/>\r\n        </v-btn>\r\n      </v-list-tile-action>\r\n    </v-list-tile>\r\n\r\n    <v-list v-if=\"isFolder\" v-show=\"open\" class=\"ml-4 pt-0 pb-0\" dense transition=\"scale-transition\">\r\n      <tree-item\r\n        class=\"item\"\r\n        v-for=\"(model, index) in model.children\"\r\n        :key=\"index\"\r\n        :model=\"model\"\r\n        :url=\"url\"\r\n        :isEdit=\"isEdit\"\r\n        :nodes=\"nodes\"\r\n        :parentState=\"open\"\r\n        @handleAdd=\"handleAdd\"\r\n        @handleEdit=\"handleEdit\"\r\n        @handleDelete=\"handleDelete\"\r\n        @handleClick=\"handleClick\"\r\n      >\r\n      </tree-item>\r\n    </v-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import Vue from 'vue'\r\n\r\n  export default {\r\n    name: \"tree-item\",\r\n    props: {\r\n      model: Object,\r\n      url: String,\r\n      isEdit: {\r\n        type: Boolean,\r\n        default: false\r\n      },\r\n      nodes: Object,\r\n      parentState:Boolean\r\n    },\r\n    created() {\r\n    },\r\n    data: function () {\r\n      return {\r\n        c1: '',\r\n        c2: '',\r\n        c3: '',\r\n        isSelected: false,\r\n        open:false,\r\n        beginEdit:false\r\n      }\r\n    },\r\n    watch:{\r\n      parentState(val){\r\n        if(!val){\r\n          this.open = val;\r\n        }\r\n      }\r\n    },\r\n    computed: {\r\n      isFolder: function () {\r\n        return this.model.children &&\r\n          this.model.children.length > 0\r\n      }\r\n    },\r\n    methods: {\r\n      toggle: function () {\r\n        // 将其它被选中项取消选中\r\n        this.nodes.selected.isSelected = false;\r\n        // 当前项被选中\r\n        this.isSelected = true;\r\n        // 保存当前选中项\r\n        this.nodes.selected = this\r\n\r\n        // 客户自己的点击事件回调\r\n        this.handleClick(this.model);\r\n\r\n        // 判断是否为顶级节点，顶级节点需要记录和替换\r\n        if(this.model.parentId == 0){\r\n          // 判断打开节点是否是自己\r\n          if(this.nodes.opened && this != this.nodes.opened){\r\n            // 不是，则关闭原来的节点\r\n            this.nodes.opened.open = false;\r\n          }\r\n          // 将自己记录为打开的节点\r\n          this.nodes.opened = this;\r\n        }\r\n        // 切换开闭状态\r\n        this.open = !this.open;\r\n        // 如果已经是叶子节点,或者自己是关闭的，或者自己已经有儿子了，结束\r\n        if (!this.model.isParent || this.isFolder || !this.open) {\r\n          return;\r\n        }\r\n        // 展开后查询子节点\r\n        this.$http.get(this.url, {params: {pid: this.model.id}})\r\n          .then(resp => {\r\n          Vue.set(this.model, 'children', resp.data);\r\n          // 封装当前节点的路径\r\n          this.model.children.forEach(n => {\r\n            n['path'] = [];\r\n            this.model.path.forEach(p => n['path'].push(p));\r\n            n['path'].push(n.name);\r\n          });\r\n        }).catch( e => {\r\n          console.log(e);\r\n        });\r\n      },\r\n      addChild: function () {\r\n        let child = {\r\n          id: 0,\r\n          name: '新的节点',\r\n          parentId: this.model.id,\r\n          isParent: false,\r\n          sort:this.model.children? this.model.children.length + 1:1\r\n        }\r\n        if (!this.model.isParent) {\r\n          Vue.set(this.model, 'children', [child]);\r\n          this.model.isParent = true;\r\n          this.open = true;\r\n          this.handleAdd(child);\r\n        } else {\r\n          if (!this.isFolder) {\r\n            this.$http.get(this.url, {params: {pid: this.model.id}}).then(resp => {\r\n              Vue.set(this.model, 'children', resp.data);\r\n              this.model.children.push(child);\r\n              this.open = true;\r\n              this.handleAdd(child);\r\n            });\r\n          } else {\r\n            this.model.children.push(child);\r\n            this.open = true;\r\n            this.handleAdd(child);\r\n          }\r\n        }\r\n      },\r\n      deleteChild: function () {\r\n        this.$message.confirm('此操作将永久删除数据，是否继续?', '提示', {\r\n          confirmButtonText: '确定删除',\r\n          cancelButtonText: '取消',\r\n          type: 'warning'\r\n        }).then(() => {\r\n          this.handleDelete(this.model.id);\r\n        }).catch(()=>{\r\n          this.$message.info('已取消删除');\r\n        })\r\n\r\n      },\r\n      editChild() {\r\n        this.beginEdit = true;\r\n        this.$nextTick(() => this.$refs[this.model.id].focus());\r\n      },\r\n      afterEdit() {\r\n        if (this.model.beginEdit) {\r\n          this.beginEdit = false;\r\n          this.handleEdit(this.model.id, this.model.name);\r\n        }\r\n      },\r\n      handleAdd(node) {\r\n        this.$emit(\"handleAdd\", node);\r\n      },\r\n      handleDelete(id) {\r\n        this.$emit(\"handleDelete\", id);\r\n      },\r\n      handleEdit(id, name) {\r\n        this.$emit(\"handleEdit\", id, name)\r\n      },\r\n      handleClick(node) {\r\n        this.$emit(\"handleClick\", node);\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\r\n<style scoped>\r\n  .level1 {\r\n    height: 40px;\r\n  }\r\n\r\n  .selected {\r\n    background-color: rgba(105,184,249,0.75);\r\n  }\r\n\r\n  .material-icons{\r\n    line-height:1.7\r\n  }\r\n</style>\r\n"]}]}